# NLP





## 0. å‰è¨€



æœ¬é¡¹ç›®ä¸ºååŒ—ç”µåŠ›å¤§å­¦2023å­¦å¹´åº¦è‡ªç„¶è¯­è¨€å¤„ç†ç»“è¯¾ä½œä¸š



> ä¸»è¦å‚è€ƒé¡¹ç›®è§†é¢‘è®²è§£ï¼š[ğŸ”—Bilibili](https://www.bilibili.com/video/BV163411w7qg?p=1&vd_source=92b2eaa496fe004107c04c4f55ee0fca)
>
> é¡¹ç›®å¼€æºåœ°å€ï¼š[ğŸ”—GitHub](https://github.com/shouxieai/A-series-of-NLP/blob/main/%E6%96%87%E6%9C%AC%E5%88%86%E7%B1%BB/TextCNN_%E6%96%87%E6%9C%AC%E5%88%86%E7%B1%BB/textCNN_%E6%96%87%E6%9C%AC%E5%88%86%E7%B1%BB.py)





## 1. è¯¦ç»†å®ç°æ­¥éª¤

> è¯´æ˜ï¼šbaselineå°±ä¸é˜è¿°äº†ï¼Œå¯ä»¥çœ‹å‰è¨€çš„èµ„æ–™ã€‚ è¿™éƒ¨åˆ†ä¸»è¦è¯´é’ˆå¯¹è¿™ä¸ªä½œä¸šéœ€è¦å¯¹ä¸Šè¿°æ¨¡å‹è¿›è¡Œä¿®æ”¹çš„éƒ¨åˆ†ã€‚(å‰è¨€éƒ¨åˆ†ä¸ºåˆ†ç±»é—®é¢˜ï¼Œæ‰€ä»¥éœ€è¦å¯¹è¾“å‡ºå¤´è¿›è¡Œä¿®æ”¹ï¼Œä¿®æ”¹ä¸ºå¤šæ ‡ç­¾åˆ†ç±»çš„è¾“å‡ºå¤´ï¼Œæœ€åæŠŠå…¨è¿æ¥å±‚è¾“å‡ºä¸ªæ•°æ”¹ä¸º31ä¸ªï¼ŒæŠŠæŸå¤±å‡½æ•°æ”¹ä¸ºBCELogisticså³å¯)ã€‚



- ç½‘ç»œç»“æ„ä¸è¿™ä¸ªå¤§ä½“ç›¸åŒï¼Œåœ¨max-poolingçš„åŸºç¡€ä¸Šï¼Œ~~åšäº†ä¸ªåˆ†æ”¯ï¼Œæ·»åŠ äº†ave-poolingã€‚~~(æ•ˆæœæœ‰æå‡ï¼Œä½†æ˜¯ä¸æ˜æ˜¾ï¼Œè®¡ç®—å¼€é”€æ˜æ˜¾å¢å¤§ï¼Œæ•…åˆ é™¤æ­¤éƒ¨åˆ†)



<img src="https://cdn.jsdelivr.net/gh/guoxxxxxxx/Pic-Go@main/img/202401071745515.png" alt="image-20240107174538423" style="zoom: 33%;" />

### 1.1 æ•°æ®é›†è¯»å–éƒ¨åˆ†



- é¦–å…ˆè§‚å¯Ÿæ•°æ®é›†ï¼Œæœ‰äº›æ–‡æœ¬å¯¹åº”çš„æ ‡ç­¾å¹¶ä¸å”¯ä¸€ï¼Œæœ‰ä¸€ä¸ªæ–‡æœ¬å¯¹åº”å¤šä¸ªæ ‡ç­¾çš„æƒ…å†µã€‚æ‰€ä»¥è¯¥é—®é¢˜æ˜¯ä¸€ä¸ªå¤šæ ‡ç­¾åˆ†ç±»é—®é¢˜ã€‚

<img src="https://cdn.jsdelivr.net/gh/guoxxxxxxx/Pic-Go@main/img/202312281557467.png" alt="image-20231226082033933" style="zoom: 50%;" />



- ç”±äºè¯¥é—®é¢˜æ—¶å¤šæ ‡ç­¾åˆ†ç±»é—®é¢˜ï¼Œæ‰€ä»¥Datasetä¸­è¿”å›çš„labelæ¯”è¾ƒé€‚åˆé‡‡ç”¨one-hotç¼–ç æ¥å†™ï¼Œå¦‚æœç›´æ¥è¿”å›labelåˆ™å›æŠ¥é”™ï¼Œå› ä¸ºå…¶æ˜¯è¾¹é•¿çš„ï¼Œé‡‡ç”¨one-hotç¼–ç å¯ä»¥æœ‰æ•ˆè§£å†³è¯¥é—®é¢˜ã€‚ä»£ç è¯¦è§: $classifier/data/dataset.py$

  

- é€šè¿‡åˆ†å¸ƒå¯ä»¥çœ‹å‡ºè®­ç»ƒé›†ä¸­ç»å¤§å¤šæ•°å¥å­éƒ½åœ¨500è¯ä»¥ä¸‹ï¼ˆé€šè¿‡éªŒè¯åªæœ‰6ä¸ªå¥å­åœ¨500è¯ä»¥ä¸Šï¼‰æ‰€ä»¥æ¯ä¸ªå¥å­çš„æœ€å¤§é•¿åº¦å–500ã€‚ä»£ç è¯¦è§: $classifier/data/dataset.py$

  

<img src="https://cdn.jsdelivr.net/gh/guoxxxxxxx/Pic-Go@main/img/202312281557391.png" alt="image-20231226193424361" style="zoom: 80%;" />

<img src="https://cdn.jsdelivr.net/gh/guoxxxxxxx/Pic-Go@main/img/202312281557432.png" alt="image-20231226194442358" style="zoom:50%;" />



``` python
 def __getitem__(self, idx):
        text = self.dataset[idx][:self.max_length]    # å¦‚æœå¥å­é•¿åº¦å¤§äºmax_lengthåˆ™å¯¹å…¶è¿›è¡Œæˆªå–
        text_idx = [self.word2index.get(i, 1) for i in text]     # å°†å•è¯è½¬åŒ–ä¸ºç¼–ç , ä½¿ç”¨getæ–¹æ³•æ˜¯å› ä¸ºå¦‚æœè¯åœ¨è¯å…¸ä¸­ä¸å­˜åœ¨çš„è¯ï¼Œç”¨1è¿›è¡Œæ›¿æ¢ï¼Œ1å®šä¹‰ä¸º<UNK>
        text_idx = text_idx + [0] * (self.max_length - len(text_idx))   # å¦‚æœå¥å­é•¿åº¦å°äºmax_length, è¡¥å…¨åˆ°max_lengthé•¿åº¦
        if self.mode in ['train', 'val']:
            # ç”±äºæ—¶å¤šæ ‡ç­¾ä»»åŠ¡ï¼Œæ‰€ä»¥é‡‡ç”¨ç‹¬çƒ­ç çš„æ–¹å¼æ¯ä¸ªlabelå…±è®¡31ä½, ç¡®ä¿labelsé•¿åº¦ä¸€æ ·
            label = self.labels[idx]
            one_hot_label = torch.zeros(config['nc'])
            one_hot_label[label] = 1
            return torch.tensor(text_idx).unsqueeze(dim=0), one_hot_label
        else:
            return torch.tensor(text_idx).unsqueeze(dim=0)
```




### 1.2 è¾“å‡ºå¤´éƒ¨åˆ†ä¿®æ”¹



- ç”±äºå…±æœ‰31ä¸ªç±»åˆ«ï¼Œä¸”ä¸ºå¤šæ ‡ç­¾åˆ†ç±»ï¼Œæ‰€ä»¥åœ¨æœ€åçš„è¾“å‡ºä¸Šåº”è¯¥æœ‰31ä¸ªè¾“å‡ºï¼Œè¡¨ç¤ºæ¯ä¸ªç±»åˆ«çš„å¯èƒ½æ€§ã€‚è¿™éƒ¨åˆ†ä¸»è¦åœ¨$classifier/nn/model.py$æ–‡ä»¶ä¸­ä½“ç°ã€‚å…¶ä¸­$config['nc']$ä»£è¡¨ç±»åˆ«æ•°ã€‚

  <img src="https://cdn.jsdelivr.net/gh/guoxxxxxxx/Pic-Go@main/img/202312281557472.png" alt="image-20231228155707037" style="zoom:50%;" />

  - æ¯è¡Œæ–‡æœ¬ç»æ¨¡å‹é¢„æµ‹å¾—åˆ°çš„è¾“å‡ºæœ‰31ä¸ªå€¼ï¼Œåˆ†åˆ«ä»£è¡¨31ä¸ªç±»åˆ«çš„æ¦‚ç‡ã€‚è¿™31ä¸ªå€¼çš„ç›®å‰æ˜¯åœ¨æ•´ä¸ªå®æ•°åŸŸä¸Šï¼Œä¹Ÿå°±æ˜¯å–å€¼ä¸ºè´Ÿæ— ç©·åˆ°æ­£æ— ç©·ã€‚æ‰€ä»¥æŸå¤±å‡½æ•°ä½¿ç”¨$BCEWithLogitsLoss$ä½œä¸ºæŸå¤±å‡½æ•°ï¼Œç›¸å½“äºåœ¨åšæŸå¤±å‡½æ•°ä¹‹å‰ï¼Œåšäº†ä¸€ä¸‹$Sigmoid$ã€‚ä»£ç å®ç°è¯·è§æ–‡ä»¶å¤¹$classifier/engine/trainer.py$



- å¯¹äºéªŒè¯é›†éªŒè¯éƒ¨åˆ†ï¼Œé€šè¿‡è®­ç»ƒçš„æ¨¡å‹å¯¹éªŒè¯é›†è¿›è¡ŒéªŒè¯æ—¶ï¼Œè¾“å‡ºå’Œä¸Šè¿°æƒ…å†µä¸€æ ·ï¼Œæ‰€ä»¥ä¹Ÿéœ€è¦è¿›è¡Œä¸€ä¸‹$Sigmoid$æ“ä½œï¼Œå°†é¢„æµ‹å€¼æ˜ å°„åˆ°$[0, 1]$ä¹‹é—´ã€‚ä»£ç è¯·è§æ–‡ä»¶$classifier/engine/validator.py$

  ``` python
  def validator(net, val_dataloader, device):
      """
      ç”¨äºæ¯ä¸ªepochç»“æŸåå¯¹é¢„æµ‹é›†è¿›è¡Œè¯„ä¼°
      :param net: ç½‘ç»œæ¨¡å‹
      :param val_dataloader: éªŒè¯é›†çš„dataloader
      :param device: è®¾å¤‡
      :return:
      """
      with torch.no_grad():
          acc_list = []
          for x, label in tqdm(val_dataloader, desc='Validating: '):
              x, label = x.to(device), label.to(device)
              pred = net(x)
              # é€šè¿‡sigmoidæ˜ å°„ä¹‹åå€¼å°±åˆ†å¸ƒåœ¨äº†0ï¼Œ1ä¹‹é—´ï¼Œç›¸å½“äºæ¦‚ç‡ï¼Œå½“æ¦‚ç‡å°äº0.5æ—¶ï¼Œåˆ™è®¤ä¸ºå…¶ä¸å±äºè¿™ä¸ªç±»åˆ«ã€‚å¤§äº0.5æ—¶åˆ™è®¤ä¸ºå…¶å±äºè¿™ä¸ªç±»åˆ«
              bin_pred = (torch.sigmoid(pred) > 0.5).float()
              # åˆ¤æ–­æ¯å¥è¯çš„æ¯ä¸ªç±»åˆ«æ˜¯å¦é¢„æµ‹æ­£ç¡®
              correct = bin_pred == label
              # ä¸‹é¢è¿™æ®µçš„æ„æ€æ—¶ï¼Œåªæœ‰è¿™å¥è¯çš„ç±»åˆ«éƒ½é¢„æµ‹æ­£ç¡®ï¼Œæ‰ç®—æ­£ç¡®ã€‚
              correct = correct.all(dim=1).float()
              ave_acc = correct.sum().item() / len(label)
              acc_list.append(ave_acc)
          # è¿”å›å‡†ç¡®ç‡
          return sum(acc_list) / len(acc_list)
  ```




### 1.3 è¶…å‚æ•°ä¿®æ”¹

- å¦‚æœä¿®æ”¹è¶…å‚æ•°è¯·è§æ–‡ä»¶$config/config.yaml$

  ``` yaml
  # é…ç½®æ–‡ä»¶
  label2dict_path: /datasets/label2dict.yaml  # æ ‡ç­¾åˆ°å­—å…¸çš„æ˜ å°„
  dict2label_path: /datasets/dict2label.yaml  # å­—å…¸æ˜ å°„åˆ°æ ‡ç­¾æ–‡ä»¶
  words_dict_path: /datasets/words_dict.json  # å­—å…¸ä¿å­˜è·¯å¾„
  train_path: /datasets/train.json  # æ•°æ®é›†çš„è·¯å¾„
  valid_path: /datasets/valid.json  # éªŒè¯é›†çš„è·¯å¾„
  test_path: /datasets/test.txt   # æµ‹è¯•é›†çš„è·¯å¾„
  word2index_path: /datasets/word2index.yaml  # word2indexæ–‡ä»¶ ç›®å‰æ²¡ç”¨
  save_path: /runs/train    # æ¨¡å‹ä¿å­˜è·¯å¾„
  save_predict_path: /runs/predict  # é¢„æµ‹æ—¶ä¿å­˜çš„è·¯å¾„
  save_val_path: /runs/valid    # å•ç‹¬è¿è¡ŒéªŒè¯ç¨‹åºæ—¶ä¿å­˜çš„è·¯å¾„
  
  # è¶…å‚æ•°è®¾å®š
  max_length: 500   # å¥å­çš„æœ€é•¿é•¿åº¦
  embedding_dim: 256  # æ¯ä¸ªå•è¯ç”¨å‡ ä¸ªå€¼è¡¨ç¤º
  batch_size: 512    # è®­ç»ƒæ—¶æ¯ä¸ªæ‰¹æ¬¡çš„å¤§å°
  epoch: 1     # è®­ç»ƒçš„è½®æ•°
  learning_rate: 0.001   # å­¦ä¹ ç‡
  num_workers: 0    # è¯»å–æ•°æ®çš„è¿›ç¨‹æ•°
  
  # æ¨¡å‹ç›¸å…³å‚æ•°è®¾å®š
  nc: 31    # ç±»åˆ«æ•°
  hidden_layer: 256   # éšè—å±‚æ•°é‡(é€šé“æ•°)
  ```

  



## 2. ç¨‹åºè¿è¡Œè¯¦è§£



- æ­¥éª¤1ï¼š è§£å‹æ–‡ä»¶ï¼Œå¹¶è¿›å…¥åˆ°æ–‡ä»¶å¤¹

  <img src="https://cdn.jsdelivr.net/gh/guoxxxxxxx/Pic-Go@main/img/202312281709376.png" alt="image-20231228170921284" style="zoom: 33%;" />



- æ­¥éª¤2ï¼šåœ¨å‘½ä»¤è¡Œä¸‹é¡ºåºè¾“å…¥å¦‚ä¸‹æŒ‡ä»¤

``` cmd
conda create -n NLP python=3.11		# åˆ›å»ºæ–°çš„ç¯å¢ƒ
conda activate NLP		# åˆ‡æ¢åˆ°æ–°ç¯å¢ƒ

pip install -r requirement.txt		# å®‰è£…ç›¸å…³ä¾èµ–
```

> æç¤ºï¼š å¦‚æœå®‰è£…ä¾èµ–æ—¶ï¼Œåˆ°å®‰è£…torchåŒ…æŠ¥é”™çš„è¯ï¼Œå¯ä»¥æŠŠæœ‰å…³torchçš„é‚£å‡ è¡Œæ³¨é‡Šæ‰(å‰é¢åŠ #å·å°±è¡Œ)ï¼Œå»å®˜ç½‘å®‰è£…
>
> å®˜ç½‘åœ°å€ä¸º: https://pytorch.org/get-started/locally/
>
> é€‰æ‹©å¯¹åº”çš„ç‰ˆæœ¬å®‰è£…å³å¯ï¼Œ

<img src="https://cdn.jsdelivr.net/gh/guoxxxxxxx/Pic-Go@main/img/202312281754732.png" alt="image-20231228171646955" style="zoom:33%;" />

- æ­¥éª¤3ï¼šåœ¨Pycharmæ‰“å¼€é¡¹ç›®æ–‡ä»¶ï¼Œé€‰æ‹©åˆšæ‰è£…å¥½çš„ç¯å¢ƒå³å¯è¿è¡Œ



- è¿è¡Œæ–‡ä»¶
  - å¦‚æœè®­ç»ƒçš„è¯è¿è¡Œ $train.py$å³å¯
  - å¦‚æœéªŒè¯éªŒè¯é›†çš„è¯è¿è¡Œ$valid.py$å³å¯
  - å¦‚æœé¢„æµ‹æµ‹è¯•é›†çš„å†…å®¹è¯è¿è¡Œ$predict.py$å³å¯



## 3. ç¨‹åºè¿è¡Œæƒ…å†µ

> è¿™é‡Œä»¥TextCNNä¸ºä¾‹ï¼Œå…¶ä»–éƒ½ä¸€æ ·



- è·‘äº†50è½®å®éªŒç»“æœå¦‚ä¸‹

  - æŸå¤±å‡½æ•°åŠç²¾åº¦æ›²çº¿å¦‚ä¸‹(éªŒè¯é›†ä¸Šçš„ç²¾åº¦åœ¨85%å·¦å³)

    <img src="https://cdn.jsdelivr.net/gh/guoxxxxxxx/Pic-Go@main/img/202312281754131.png" alt="image-20231228172405338" style="zoom: 33%;" />

  - è®­ç»ƒæ—¥å¿—æ–‡ä»¶å¦‚ä¸‹ï¼š

    ``` txt
    ... ä¸Šè¿°è½®æ•°çœç•¥, è¯·è§é¡¹ç›®æ–‡ä»¶
    epoch: 48 : loss: 0.00112865 	 accuracy: 0.85228954
    epoch: 49 : loss: 0.00047265 	 accuracy: 0.83601856
    epoch: 50 : loss: 0.00248988 	 accuracy: 0.85001596
    âœ¨éªŒè¯é›†ä¸Šçš„æœ€ä¼˜å‡†ç¡®ç‡ä¸º: 0.85326610
    ğŸˆæœ€ä¼˜æ¨¡å‹æƒé‡å·²ä¿å­˜è‡³: F:\Programs\Python\AI\PyCharm\NLP/runs/train/run_1\weights\best.pt
    âœŒï¸æµ‹è¯•é›†çš„é¢„æµ‹ç»“æœå·²å­˜å‚¨åœ¨: F:\Programs\Python\AI\PyCharm\NLP/runs/train/run_1/test_predict(submission).txt
    ```



- è¯´æ˜

  - $test\_predict(submission).txt$æ–‡ä»¶ä¸ºé¢„æµ‹éªŒè¯é›†çš„æ–‡ä»¶ï¼ŒéªŒè¯é›†çš„çœŸå®å€¼å¯ä»¥çœ‹æ–‡ä»¶$datasets/valid\_label.txt$å¯ä»¥ç›´è§‚çš„åšå¯¹æ¯”ã€‚éƒ¨åˆ†å¯¹æ¯”å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

    ![image-20231228173124801](https://cdn.jsdelivr.net/gh/guoxxxxxxx/Pic-Go@main/img/202312281753893.png)

    - è¯´æ˜ï¼šï¼ˆå·¦ä¾§éƒ¨åˆ†ä¸ºçœŸå®å€¼ï¼Œå³ä¾§éƒ¨åˆ†ä¸ºé¢„æµ‹å€¼ï¼‰

      çº¢è‰²æ¡†é€‰éƒ¨åˆ†ï¼šä¸¤è¾¹å¯¹ä¸ä¸Šï¼Œè¯´æ˜é¢„æµ‹é”™è¯¯ã€‚

      è“è‰²éƒ¨åˆ†ï¼šä¹‹æ‰€ä»¥é¢„æµ‹å€¼ä¸ºç©ºï¼Œæ˜¯å› ä¸ºè¿™æ˜¯ä¸€ä¸ªå¤šæ ‡ç­¾åˆ†ç±»ï¼Œç¨‹åºè®¤ä¸ºç¼–å·ä¸º47çš„è¯­å¥ä¸å±äºä»»ä½•ä¸€ç±»ï¼Œæ‰€ä»¥ç±»åˆ«ä¸ºç©ºå€¼ã€‚



## å„ç§æ¨¡å‹å¯¹æ¯”

### â‘  TextCNN

- è·‘äº†50è½®å®éªŒç»“æœå¦‚ä¸‹

  - æŸå¤±å‡½æ•°åŠç²¾åº¦æ›²çº¿å¦‚ä¸‹(éªŒè¯é›†ä¸Šçš„ç²¾åº¦åœ¨85%å·¦å³)

    <img src="https://cdn.jsdelivr.net/gh/guoxxxxxxx/Pic-Go@main/img/202401081621198.png" alt="image-20240108162124134" style="zoom:33%;" />

  - è®­ç»ƒæ—¥å¿—æ–‡ä»¶å¦‚ä¸‹ï¼š

    ``` txt
    ... ä¸Šè¿°è½®æ•°çœç•¥, è¯·è§é¡¹ç›®æ–‡ä»¶
    epoch: 47 : loss: 0.00148951 	 accuracy: 0.85034148
    epoch: 48 : loss: 0.00082848 	 accuracy: 0.84903940
    epoch: 49 : loss: 0.00134372 	 accuracy: 0.84676582
    epoch: 50 : loss: 0.00067405 	 accuracy: 0.84676075
    âœ¨éªŒè¯é›†ä¸Šçš„æœ€ä¼˜å‡†ç¡®ç‡ä¸º: 0.85587280
    ğŸˆæœ€ä¼˜æ¨¡å‹æƒé‡å·²ä¿å­˜è‡³: F:\Programs\Python\AI\PyCharm\NLP/runs/train/run_0\weights\best.pt
    âœŒï¸æµ‹è¯•é›†çš„é¢„æµ‹ç»“æœå·²å­˜å‚¨åœ¨: F:\Programs\Python\AI\PyCharm\NLP/runs/train/run_0/test_predict(submission).txt
    ```
  
  - è¶…å‚æ•°è®¾å®šå¦‚ä¸‹ï¼š
  
    ``` yaml
    # è¶…å‚æ•°è®¾å®š
    max_length: 500   # å¥å­çš„æœ€é•¿é•¿åº¦
    embedding_dim: 256  # æ¯ä¸ªå•è¯ç”¨å‡ ä¸ªå€¼è¡¨ç¤º
    batch_size: 512    # è®­ç»ƒæ—¶æ¯ä¸ªæ‰¹æ¬¡çš„å¤§å°
    epoch: 50     # è®­ç»ƒçš„è½®æ•°
    learning_rate: 0.001   # å­¦ä¹ ç‡
    num_workers: 0    # è¯»å–æ•°æ®çš„è¿›ç¨‹æ•°
    
    # æ¨¡å‹ç›¸å…³å‚æ•°è®¾å®š
    nc: 31    # ç±»åˆ«æ•°
    hidden_layer: 256   # éšè—å±‚æ•°é‡(é€šé“æ•°)
    ```
  



### â‘¡ LSTM

è·‘äº†100è½®å®éªŒç»“æœå¦‚ä¸‹

- æŸå¤±å‡½æ•°åŠç²¾åº¦æ›²çº¿å¦‚ä¸‹(éªŒè¯é›†ä¸Šçš„ç²¾åº¦åœ¨85%å·¦å³)

  <img src="https://cdn.jsdelivr.net/gh/guoxxxxxxx/Pic-Go@main/img/202401080939889.png" alt="image-20240108093900814" style="zoom:33%;" />

- è®­ç»ƒæ—¥å¿—æ–‡ä»¶å¦‚ä¸‹ï¼š

  ``` txt
  epoch: 97 : loss: 0.00153342 	 accuracy: 0.84416925
  epoch: 98 : loss: 0.00063166 	 accuracy: 0.84969551
  epoch: 99 : loss: 0.00065774 	 accuracy: 0.84416672
  epoch: 100 : loss: 0.00027758 	 accuracy: 0.84741939
  âœ¨éªŒè¯é›†ä¸Šçš„æœ€ä¼˜å‡†ç¡®ç‡ä¸º: 0.85033641
  ğŸˆæœ€ä¼˜æ¨¡å‹æƒé‡å·²ä¿å­˜è‡³: F:\Programs\Remote_Project\TextCNN\TextCNN-Classifier/runs/train/run_44\weights\best.pt
  âœŒï¸æµ‹è¯•é›†çš„é¢„æµ‹ç»“æœå·²å­˜å‚¨åœ¨: F:\Programs\Remote_Project\TextCNN\TextCNN-Classifier/runs/train/run_44/test_predict(submission).txt
  ```

- è¶…å‚æ•°è®¾å®šå¦‚ä¸‹ï¼š

  ``` yaml
  # è¶…å‚æ•°è®¾å®š
  max_length: 150   # å¥å­çš„æœ€é•¿é•¿åº¦
  embedding_dim: 512  # æ¯ä¸ªå•è¯ç”¨å‡ ä¸ªå€¼è¡¨ç¤º
  batch_size: 512    # è®­ç»ƒæ—¶æ¯ä¸ªæ‰¹æ¬¡çš„å¤§å°
  epoch: 100     # è®­ç»ƒçš„è½®æ•°
  learning_rate: 0.001   # å­¦ä¹ ç‡
  num_workers: 0    # è¯»å–æ•°æ®çš„è¿›ç¨‹æ•°
  
  # æ¨¡å‹ç›¸å…³å‚æ•°è®¾å®š
  nc: 31    # ç±»åˆ«æ•°
  
  # TextCNNæ¨¡å‹å‚æ•°
  hidden_layer: 256   # éšè—å±‚æ•°é‡(é€šé“æ•°) 
  conv_kernel_list: [3, 5, 7, 11, 17, 25]
  
  # LSTMæ¨¡å—å‚æ•°
  lstm_hidden_size: 512
  lstm_num_layers: 1
  lstm_bidirectional: True    # æ˜¯å¦å¯ç”¨åŒå‘LSTM
  ```

- ä¸åŒè¶…å‚æ•°ä¸‹LSTMæ¨¡å‹æ€§èƒ½æƒ…å†µ

  | ç¼–å· | è®­ç»ƒè½®æ•° | å¥å­æœ€å¤§é•¿åº¦ | è¯å‘é‡é•¿åº¦ | hidden_layer | num_layers | bidirectional | éªŒè¯é›†ç²¾åº¦ |
  | ---- | -------- | ------------ | ---------- | ------------ | ---------- | ------------- | ---------- |
  | 01   | 50       | 300          | 300        | 256          | 2          | True          | 83.05      |
  | 02   | 50       | 150          | 300        | 256          | 2          | True          | 83.57      |
  | 03   | 50       | 150          | 300        | 256          | 4          | True          | 83.01      |
  | 04   | 50       | 150          | 300        | 256          | 1          | True          | 83.44      |
  | 05   | 50       | 150          | 300        | 256          | 2          | False         | 80.35      |
  | 06   | 50       | 200          | 256        | 256          | 1          | True          | 82.72      |





## é™„å½•

é¡¹ç›®æ–‡ä»¶ç»“æ„

$NLP$ é¡¹ç›®æ ¹ç›®å½•

- $classifier$ åŒ…ï¼Œæ•´ä¸ªç¨‹åºçš„æ ¸å¿ƒä»£ç åœ¨æ­¤å¤„
  - $conf$ï¼šè¯»å–é…ç½®çš„åŒ…
    - $readConfig.py$	é…ç½®è„šæœ¬ï¼Œè¿™éƒ¨åˆ†å†…å®¹æ—¶ä¸ºäº†è¯»å–$config.yaml$é…ç½®æ–‡ä»¶
  - $data$: è¯»å–æ•°æ®çš„åŒ…
    - $dataset.py$		æ•°æ®è¯»å–è„šæœ¬ï¼Œè¿™éƒ¨åˆ†ä¸»è¦æ˜¯è¯»å–æ•°æ®
    - $loaders.py$   è¿™éƒ¨åˆ†æ˜¯è·å–$dataloader$è¿­ä»£å™¨ï¼Œæ›´å¥½çš„è·å–æ•°æ®
  - $engine$: è®­ç»ƒå’ŒéªŒè¯çš„ä»£ç åŒ…
    - $trainer.py$ è¿™éƒ¨åˆ†æ˜¯ä¸»è¦åŒ…å«è®­ç»ƒçš„ä»£ç 
    - $validator.py$ è¿™éƒ¨åˆ†ä¸»è¦åŒ…å«éªŒè¯éªŒè¯é›†å’Œé¢„æµ‹æµ‹è¯•é›†çš„ä»£ç 
  - $nn$: æ¨¡å‹ä»£ç åŒ…
    - $model.py$ æ­¤æ–‡ä»¶ä¸­æ˜¯æ„å»ºæ¨¡å‹çš„ä»£ç 
  - $utils$ï¼š å·¥å…·åŒ…
    - $plotting.py$ ç»˜åˆ¶å›¾åƒçš„ä»£ç 
    - $process.py$ å¯¹æ•°æ®é›†è¿›è¡Œç®€å•æŸ¥çœ‹çš„ä»£ç ï¼Œå¦‚é•¿åº¦å•Šä»€ä¹ˆçš„ï¼Œæ²¡ç”¨äº†ç°åœ¨ï¼Œä¸ç”¨çœ‹è¿™ä¸ª
    - $save.py$ æ¨¡å‹ä¿å­˜ä»¥åŠæ—¥å¿—æ–‡ä»¶ä¿å­˜çš„ä»£ç 
- $config$æ–‡ä»¶å¤¹
  - $config.yaml$	é…ç½®ç±»
- $datasets$æ–‡ä»¶å¤¹
  - $dict2label.yaml$	å°†å­—å…¸è½¬åŒ–ä¸ºæ ‡ç­¾çš„æ˜ å°„æ–‡ä»¶
  - $label2dict.yaml$ å°†æ ‡ç­¾è½¬åŒ–ä¸ºå­—å…¸çš„æ˜ å°„æ–‡ä»¶
  - $label\_list.txt$  ç±»åˆ«
  - $test.txt$ æµ‹è¯•é›†
  - $train.json$ è®­ç»ƒé›†
  - $valid.json$ éªŒè¯é›†
  - $valid\_label.txt$  éªŒè¯é›†çš„å•ç‹¬æ ‡ç­¾ç‰ˆï¼Œä¸»è¦æ˜¯æ–¹ä¾¿å¯¹ç…§ç€çœ‹ï¼Œç¨‹åºé‡Œæ²¡ç”¨
  - $words_dict.json$ ç¨‹åºè‡ªåŠ¨æ„å»ºçš„è¯å…¸
- $runs$æ–‡ä»¶å¤¹
  - $predict$ å•ç‹¬æ‰§è¡Œ$predict.py$æ—¶çš„ä¿å­˜è·¯å¾„
  - $train$ æ‰§è¡Œ$train.py$æ–‡ä»¶æ—¶ä¿å­˜çš„è·¯å¾„
  - $valid$ æ‰§è¡Œ$valid.py$æ—¶ä¿å­˜çš„è·¯å¾„
